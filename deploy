root@client:~/tiup# tiup cluster deploy tidb-test v6.1.1 ./topology.yaml --user root -i /root/bin/hstream-aliyun.pem 
tiup is checking updates for component cluster ...
Starting component `cluster`: /root/.tiup/components/cluster/v1.11.0/tiup-cluster deploy tidb-test v6.1.1 ./topology.yaml --user root -i /root/bin/hstream-aliyun.pem



+ Detect CPU Arch Name
  - Detecting node 172.24.47.175 Arch info ... Done
  - Detecting node 172.24.47.174 Arch info ... Done
  - Detecting node 172.24.47.173 Arch info ... Done



+ Detect CPU OS Name
  - Detecting node 172.24.47.175 OS info ... Done
  - Detecting node 172.24.47.174 OS info ... Done
  - Detecting node 172.24.47.173 OS info ... Done
Please confirm your topology:
Cluster type:    tidb
Cluster name:    tidb-test
Cluster version: v6.1.1
Role        Host           Ports        OS/Arch       Directories
----        ----           -----        -------       -----------
pd          172.24.47.175  2379/2380    linux/x86_64  /tidb-deploy/pd-2379,/tidb-data/pd-2379
pd          172.24.47.174  2379/2380    linux/x86_64  /tidb-deploy/pd-2379,/tidb-data/pd-2379
pd          172.24.47.173  2379/2380    linux/x86_64  /tidb-deploy/pd-2379,/tidb-data/pd-2379
tikv        172.24.47.175  20160/20180  linux/x86_64  /tidb-deploy/tikv-20160,/tidb-data/tikv-20160
tikv        172.24.47.174  20160/20180  linux/x86_64  /tidb-deploy/tikv-20160,/tidb-data/tikv-20160
tikv        172.24.47.173  20160/20180  linux/x86_64  /tidb-deploy/tikv-20160,/tidb-data/tikv-20160
tidb        172.24.47.175  4000/10080   linux/x86_64  /tidb-deploy/tidb-4000
tidb        172.24.47.174  4000/10080   linux/x86_64  /tidb-deploy/tidb-4000
tidb        172.24.47.173  4000/10080   linux/x86_64  /tidb-deploy/tidb-4000
prometheus  172.24.47.175  9090/12020   linux/x86_64  /tidb-deploy/prometheus-9090,/tidb-data/prometheus-9090
grafana     172.24.47.175  3000         linux/x86_64  /tidb-deploy/grafana-3000
Attention:
    1. If the topology is not what you expected, check your yaml file.
    2. Please confirm there is no port/directory conflicts in same host.
Do you want to continue? [y/N]: (default=N) 

+ Generate SSH keys ... Done                 
+ Download TiDB components                         
  - Download pd:v6.1.1 (linux/amd64) ... Done      
  - Download tikv:v6.1.1 (linux/amd64) ... Done    
  - Download tidb:v6.1.1 (linux/amd64) ... Done
  - Download prometheus:v6.1.1 (linux/amd64) ... Done
  - Download grafana:v6.1.1 (linux/amd64) ... Done
  - Download node_exporter: (linux/amd64) ... Done
  - Download blackbox_exporter: (linux/amd64) ... Done
+ Initialize target host environments             
  - Prepare 172.24.47.175:22 ... Done             
  - Prepare 172.24.47.174:22 ... Done
  - Prepare 172.24.47.173:22 ... Done       
+ Deploy TiDB instance                            
  - Copy pd -> 172.24.47.175 ... Done
  - Copy pd -> 172.24.47.174 ... Done       
  - Copy pd -> 172.24.47.173 ... Done             
  - Copy tikv -> 172.24.47.175 ... Done
  - Copy tikv -> 172.24.47.174 ... Done
  - Copy tikv -> 172.24.47.173 ... Done
  - Copy tidb -> 172.24.47.175 ... Done
  - Copy tidb -> 172.24.47.174 ... Done
  - Copy tidb -> 172.24.47.173 ... Done
  - Copy prometheus -> 172.24.47.175 ... Done
  - Copy grafana -> 172.24.47.175 ... Done
  - Deploy node_exporter -> 172.24.47.175 ... Done
  - Deploy node_exporter -> 172.24.47.174 ... Done
  - Deploy node_exporter -> 172.24.47.173 ... Done
  - Deploy blackbox_exporter -> 172.24.47.173 ... Done
  - Deploy blackbox_exporter -> 172.24.47.175 ... Done
  - Deploy blackbox_exporter -> 172.24.47.174 ... Done
+ Copy certificate to remote host                                                                                        
+ Init instance configs
  - Generate config pd -> 172.24.47.175:2379 ... Done
  - Generate config pd -> 172.24.47.174:2379 ... Done
  - Generate config pd -> 172.24.47.173:2379 ... Done
  - Generate config tikv -> 172.24.47.175:20160 ... Done
  - Generate config tikv -> 172.24.47.174:20160 ... Done
  - Generate config tikv -> 172.24.47.173:20160 ... Done
  - Generate config tidb -> 172.24.47.175:4000 ... Done
  - Generate config tidb -> 172.24.47.174:4000 ... Done
  - Generate config tidb -> 172.24.47.173:4000 ... Done
  - Generate config prometheus -> 172.24.47.175:9090 ... Done
  - Generate config grafana -> 172.24.47.175:3000 ... Done
+ Init monitor configs
  - Generate config node_exporter -> 172.24.47.175 ... Done
  - Generate config node_exporter -> 172.24.47.174 ... Done
  - Generate config node_exporter -> 172.24.47.173 ... Done
  - Generate config blackbox_exporter -> 172.24.47.175 ... Done
  - Generate config blackbox_exporter -> 172.24.47.174 ... Done
  - Generate config blackbox_exporter -> 172.24.47.173 ... Done
+ Check status
Enabling component pd
        Enabling instance 172.24.47.173:2379
        Enabling instance 172.24.47.174:2379
        Enabling instance 172.24.47.175:2379
        Enable instance 172.24.47.173:2379 success
        Enable instance 172.24.47.175:2379 success
        Enable instance 172.24.47.174:2379 success
Enabling component tikv
        Enabling instance 172.24.47.173:20160
        Enabling instance 172.24.47.175:20160
        Enabling instance 172.24.47.174:20160
        Enable instance 172.24.47.173:20160 success
        Enable instance 172.24.47.174:20160 success
        Enable instance 172.24.47.175:20160 success
Enabling component tidb
        Enabling instance 172.24.47.173:4000
        Enabling instance 172.24.47.174:4000
        Enabling instance 172.24.47.175:4000
        Enable instance 172.24.47.173:4000 success
        Enable instance 172.24.47.174:4000 success
        Enable instance 172.24.47.175:4000 success
Enabling component prometheus
        Enabling instance 172.24.47.175:9090
        Enable instance 172.24.47.175:9090 success
Enabling component grafana
        Enabling instance 172.24.47.175:3000
        Enable instance 172.24.47.175:3000 success
Enabling component node_exporter
        Enabling instance 172.24.47.175
        Enabling instance 172.24.47.174
        Enabling instance 172.24.47.173
        Enable 172.24.47.174 success
        Enable 172.24.47.173 success
        Enable 172.24.47.175 success
Enabling component blackbox_exporter
        Enabling instance 172.24.47.175
        Enabling instance 172.24.47.173
        Enabling instance 172.24.47.174
        Enable 172.24.47.173 success
        Enable 172.24.47.174 success
        Enable 172.24.47.175 success
Cluster `tidb-test` deployed successfully, you can start it with command: `tiup cluster start tidb-test --init`



root@client:~/tiup# tiup cluster start tidb-test --init                                                                                                                                                                                           
tiup is checking updates for component cluster ...                                                                                                                                                                                                
Starting component `cluster`: /root/.tiup/components/cluster/v1.11.0/tiup-cluster start tidb-test --init                                                                                                                                          
Starting cluster tidb-test...                                                                                                                                                                                                                     
+ [ Serial ] - SSHKeySet: privateKey=/root/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa, publicKey=/root/.tiup/storage/cluster/clusters/tidb-test/ssh/id_rsa.pub                                                                           
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.174                                                                                                                                                                                             
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.175                                                                                                                                                                                             
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.173                                                                                                                                                                                             
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.173
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.174
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.174
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.175
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.173
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.175
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.175
+ [Parallel] - UserSSH: user=tidb, host=172.24.47.175
+ [ Serial ] - StartCluster
Starting component pd
        Starting instance 172.24.47.173:2379
        Starting instance 172.24.47.175:2379
        Starting instance 172.24.47.174:2379
        Start instance 172.24.47.173:2379 success
        Start instance 172.24.47.174:2379 success
        Start instance 172.24.47.175:2379 success
Starting component tikv
        Starting instance 172.24.47.173:20160
        Starting instance 172.24.47.174:20160
        Starting instance 172.24.47.175:20160
        Start instance 172.24.47.174:20160 success
        Start instance 172.24.47.173:20160 success
        Start instance 172.24.47.175:20160 success
Starting component tidb
        Starting instance 172.24.47.173:4000
        Starting instance 172.24.47.174:4000
        Starting instance 172.24.47.175:4000
        Start instance 172.24.47.173:4000 success
        Start instance 172.24.47.174:4000 success
        Start instance 172.24.47.175:4000 success
Starting component prometheus
        Starting instance 172.24.47.175:9090
        Start instance 172.24.47.175:9090 success
Starting component grafana
        Starting instance 172.24.47.175:3000
        Start instance 172.24.47.175:3000 success
Starting component node_exporter
        Starting instance 172.24.47.175
        Starting instance 172.24.47.173
        Starting instance 172.24.47.174
        Start 172.24.47.173 success
        Start 172.24.47.174 success
        Start 172.24.47.175 success
Starting component blackbox_exporter
        Starting instance 172.24.47.175
        Starting instance 172.24.47.173
        Starting instance 172.24.47.174
        Start 172.24.47.174 success
        Start 172.24.47.173 success
        Start 172.24.47.175 success
+ [ Serial ] - UpdateTopology: cluster=tidb-test
Started cluster `tidb-test` successfully
The root password of TiDB database has been changed.
The new password is: 'ub2*6YB97Z84U=AX-#'.
Copy and record it to somewhere safe, it is only displayed once, and will not be stored.
The generated password can NOT be get and shown again.

